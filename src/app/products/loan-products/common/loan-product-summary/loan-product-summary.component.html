<div class="tab-container mat-typography" *ngIf="loanProduct">

  <h3 class="mat-h3" fxFlexFill>Details</h3>

  <mat-divider [inset]="true"></mat-divider>

  <div fxFlexFill>
    <span fxFlex="47%">Name:</span>
    <span  fxFlex="53%"><b>{{ loanProduct.name }}</b></span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Short Name:</span>
    <span  fxFlex="53%">{{ loanProduct.shortName }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.fundId">
    <span fxFlex="47%">Fund Name:</span>
    <span  fxFlex="53%">{{ loanProduct.fundName }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Include in Customer Loan Counter:</span>
    <span  fxFlex="53%">{{ loanProduct.includeInBorrowerCycle | yesNo }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.startDate">
    <span fxFlex="47%">Start Date:</span>
    <span  fxFlex="53%">{{ loanProduct.startDate | dateFormat }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.closeDate">
    <span fxFlex="47%">Close Date:</span>
    <span  fxFlex="53%">{{ loanProduct.closeDate | dateFormat }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.description">
    <span fxFlex="47%">Description:</span>
    <span  fxFlex="53%">{{ loanProduct.description }}</span>
  </div>

  <h3 class="mat-h3" fxFlexFill>Currency</h3>

  <mat-divider [inset]="true"></mat-divider>

  <div fxFlexFill>
    <span fxFlex="47%">Currency:</span>
    <span  fxFlex="53%">{{ loanProduct.currency.code }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Currency:</span>
    <span  fxFlex="53%">{{ loanProduct.currency.displayLabel }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Decimal Places:</span>
    <span  fxFlex="53%">{{ loanProduct.currency.decimalPlaces }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Currency in multiples of:</span>
    <span  fxFlex="53%">{{ loanProduct.currency.inMultiplesOf }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Installment in multiples of:</span>
    <span  fxFlex="53%">{{ loanProduct.installmentAmountInMultiplesOf }}</span>
  </div>

  <h3 class="mat-h3" fxFlexFill>Terms</h3>

  <mat-divider [inset]="true"></mat-divider>

  <div fxFlexFill>
    <span fxFlex="47%">Principal:</span>
    <span  fxFlex="53%">{{ loanProduct.principal | formatNumber }}
      (Min {{ (loanProduct.minPrincipal ? loanProduct.minPrincipal : loanProduct.principal) | formatNumber }}
      : Max {{ (loanProduct.maxPrincipal ? loanProduct.maxPrincipal : loanProduct.principal) | formatNumber }})
    </span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Allow Approved / Disbursed Amounts Over Applied:</span>
    <span  fxFlex="53%">{{ loanProduct.allowApprovedDisbursedAmountsOverApplied | yesNo }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.allowApprovedDisbursedAmountsOverApplied">
    <span fxFlex="47%">Over Applied Amount:</span>
    <span fxFlex="53%" *ngIf="loanProduct.overAppliedCalculationType === 'percentage'">{{ loanProduct.overAppliedNumber
      | formatNumber
      }} %</span>
    <span fxFlex="53%" *ngIf="loanProduct.overAppliedCalculationType === 'flat'">{{ loanProduct.overAppliedNumber |
      formatNumber }} {{
      loanProduct.currencyCode }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Installment day calculation from:</span>
    <span  fxFlex="53%">{{ loanProduct.repaymentStartDateType?.value }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Number of Repayments:</span>
    <span  fxFlex="53%">{{ loanProduct.numberOfRepayments + ' (Min: ' + (loanProduct.minNumberOfRepayments ?
      loanProduct.minNumberOfRepayments : loanProduct.numberOfRepayments) + ', Max: ' +
      (loanProduct.maxNumberOfRepayments ? loanProduct.maxNumberOfRepayments : loanProduct.numberOfRepayments) + ')'
      }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Linked to floating interest rates:</span>
    <span  fxFlex="53%">{{ loanProduct.isLinkedToFloatingInterestRates | yesNo }}</span>
  </div>

  <div fxFlexFill *ngIf="!loanProduct.isLinkedToFloatingInterestRates">
    <span fxFlex="47%">Nominal interest rate:</span>
    <span  fxFlex="53%">{{ loanProduct.interestRatePerPeriod + ' (Min: ' + (loanProduct.minInterestRatePerPeriod ?
      loanProduct.minInterestRatePerPeriod : loanProduct.interestRatePerPeriod) + ', Max: ' +
      (loanProduct.maxInterestRatePerPeriod ? loanProduct.maxInterestRatePerPeriod : loanProduct.interestRatePerPeriod)
      + ')' + ' ' + loanProduct.interestRateFrequencyType?.value }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.isLinkedToFloatingInterestRates" fxLayout="row wrap" fxLayout.lt-md="column">
    <span fxFlex="47%">Floating Lending Interest Rate:</span>
    <span  fxFlex="53%">{{ loanProduct.floatingRateName }}</span>
    <span fxFlex="47%">Interest Rate Differential:</span>
    <span  fxFlex="53%">{{ loanProduct.interestRateDifferential }}</span>
    <span fxFlex="47%">Floating Interest Rate Calculation Allowed:</span>
    <span  fxFlex="53%">{{ loanProduct.isFloatingInterestRateCalculationAllowed | yesNo }}</span>
    <span fxFlex="47%">Floating Interest Rate:</span>
    <span  fxFlex="53%">{{ loanProduct.defaultDifferentialLendingRate + ' (Min: ' +
      (loanProduct.minDifferentialLendingRate ? loanProduct.minDifferentialLendingRate :
      loanProduct.defaultDifferentialLendingRate) + ', Max: ' + (loanProduct.maxDifferentialLendingRate ?
      loanProduct.maxDifferentialLendingRate : loanProduct.defaultDifferentialLendingRate) + ')' }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Terms vary based on loan cycle:</span>
    <span  fxFlex="53%">{{ loanProduct.useBorrowerCycle | yesNo }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.principalVariationsForBorrowerCycle?.length">

    <h4 class="mat-h4" fxFlexFill>Principal by loan cycle</h4>

    <table fxFlexFill class="mat-elevation-z1" mat-table [dataSource]="loanProduct.principalVariationsForBorrowerCycle">

      <ng-container matColumnDef="valueConditionType">
        <th mat-header-cell *matHeaderCellDef> Condition </th>
        <td mat-cell *matCellDef="let variation">
          {{ variation.valueConditionType.value }}
        </td>
      </ng-container>

      <ng-container matColumnDef="borrowerCycleNumber">
        <th mat-header-cell *matHeaderCellDef> Loan Cycle </th>
        <td mat-cell *matCellDef="let variation">
          {{ variation.borrowerCycleNumber }}
        </td>
      </ng-container>

      <ng-container matColumnDef="minValue">
        <th mat-header-cell *matHeaderCellDef> Minimum </th>
        <td mat-cell *matCellDef="let variation">
          {{ variation.minValue }}
        </td>
      </ng-container>

      <ng-container matColumnDef="defaultValue">
        <th mat-header-cell *matHeaderCellDef> Default </th>
        <td mat-cell *matCellDef="let variation">
          {{ variation.defaultValue }}
        </td>
      </ng-container>

      <ng-container matColumnDef="maxValue">
        <th mat-header-cell *matHeaderCellDef> Maximum </th>
        <td mat-cell *matCellDef="let variation">
          {{ variation.maxValue }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="variationsDisplayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: variationsDisplayedColumns;"></tr>

    </table>

  </div>

  <div fxFlexFill *ngIf="loanProduct.numberOfRepaymentVariationsForBorrowerCycle?.length">

    <h4 class="mat-h4" fxFlexFill>Number of Repayments by loan cycle</h4>

    <table fxFlexFill class="mat-elevation-z1" mat-table
      [dataSource]="loanProduct.numberOfRepaymentVariationsForBorrowerCycle">

      <ng-container matColumnDef="valueConditionType">
        <th mat-header-cell *matHeaderCellDef> Condition </th>
        <td mat-cell *matCellDef="let variation">
          {{ variation.valueConditionType.value }}
        </td>
      </ng-container>

      <ng-container matColumnDef="borrowerCycleNumber">
        <th mat-header-cell *matHeaderCellDef> Loan Cycle </th>
        <td mat-cell *matCellDef="let variation">
          {{ variation.borrowerCycleNumber }}
        </td>
      </ng-container>

      <ng-container matColumnDef="minValue">
        <th mat-header-cell *matHeaderCellDef> Minimum </th>
        <td mat-cell *matCellDef="let variation">
          {{ variation.minValue }}
        </td>
      </ng-container>

      <ng-container matColumnDef="defaultValue">
        <th mat-header-cell *matHeaderCellDef> Default </th>
        <td mat-cell *matCellDef="let variation">
          {{ variation.defaultValue }}
        </td>
      </ng-container>

      <ng-container matColumnDef="maxValue">
        <th mat-header-cell *matHeaderCellDef> Maximum </th>
        <td mat-cell *matCellDef="let variation">
          {{ variation.maxValue }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="variationsDisplayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: variationsDisplayedColumns;"></tr>

    </table>

  </div>

  <div fxFlexFill *ngIf="loanProduct.interestRateVariationsForBorrowerCycle?.length">

    <h4 class="mat-h4" fxFlexFill>Nominal Interest Rate by loan cycle</h4>

    <table fxFlexFill class="mat-elevation-z1" mat-table
      [dataSource]="loanProduct.interestRateVariationsForBorrowerCycle">

      <ng-container matColumnDef="valueConditionType">
        <th mat-header-cell *matHeaderCellDef> Condition </th>
        <td mat-cell *matCellDef="let variation">
          {{ variation.valueConditionType.value }}
        </td>
      </ng-container>

      <ng-container matColumnDef="borrowerCycleNumber">
        <th mat-header-cell *matHeaderCellDef> Loan Cycle </th>
        <td mat-cell *matCellDef="let variation">
          {{ variation.borrowerCycleNumber }}
        </td>
      </ng-container>

      <ng-container matColumnDef="minValue">
        <th mat-header-cell *matHeaderCellDef> Minimum </th>
        <td mat-cell *matCellDef="let variation">
          {{ variation.minValue }}
        </td>
      </ng-container>

      <ng-container matColumnDef="defaultValue">
        <th mat-header-cell *matHeaderCellDef> Default </th>
        <td mat-cell *matCellDef="let variation">
          {{ variation.defaultValue }}
        </td>
      </ng-container>

      <ng-container matColumnDef="maxValue">
        <th mat-header-cell *matHeaderCellDef> Maximum </th>
        <td mat-cell *matCellDef="let variation">
          {{ variation.maxValue }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="variationsDisplayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: variationsDisplayedColumns;"></tr>

    </table>

  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Repay Every:</span>
    <span  fxFlex="53%">{{ loanProduct.repaymentEvery + ' ' + loanProduct.repaymentFrequencyType.value }}</span>
  </div>
  
  <div fxFlexFill *ngIf="loanProduct.fixedLength">
    <span fxFlex="47%">Fixed Length:</span>
    <span  fxFlex="53%">{{ loanProduct.fixedLength + ' ' + loanProduct.repaymentFrequencyType.value }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.minimumDaysBetweenDisbursalAndFirstRepayment">
    <span fxFlex="47%">Minimum days between disbursal and first repayment date:</span>
    <span  fxFlex="53%">{{ loanProduct.minimumDaysBetweenDisbursalAndFirstRepayment }}</span>
  </div>

  <h3 class="mat-h3" fxFlexFill>Settings</h3>

  <mat-divider [inset]="true"></mat-divider>

  <div fxFlexFill *ngIf="loanProduct.amortizationType?.value">
    <span fxFlex="47%">Amortization:</span>
    <span  fxFlex="53%">{{ loanProduct.amortizationType.value }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Is Equal Amortization:</span>
    <span  fxFlex="53%">{{ loanProduct.isEqualAmortization | yesNo }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Interest Method:</span>
    <span  fxFlex="53%">{{ loanProduct.interestType?.value }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Interest Calculation Period:</span>
    <span  fxFlex="53%">{{ loanProduct.interestCalculationPeriodType?.value }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.allowPartialPeriodInterestCalculation">
    <span fxFlex="47%">Allow Partial Interest Calculation with same as repayment:</span>
    <span  fxFlex="53%">{{ loanProduct.allowPartialPeriodInterestCalculation | yesNo }}</span>
  </div>

  <h3 class="mat-h3" fxFlexFill>Loan Schedule</h3>

  <mat-divider [inset]="true"></mat-divider>

  <div fxFlexFill>
    <span fxFlex="47%">Loan Schedule Type:</span>
    <span  fxFlex="53%">{{ loanProduct.loanScheduleType.value }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Repayment Strategy:</span>
    <span  fxFlex="53%" class="repayment-strategy">{{ loanProduct.transactionProcessingStrategyName }}</span>
  </div>

  <div fxFlexFill *ngIf="isAdvancedPaymentAllocation">
    <span fxFlex="47%">Loan Schedule Processing Type:</span>
    <span  fxFlex="53%">{{ loanProduct.loanScheduleProcessingType.value }}</span>
  </div>

  <div fxFlexFill *ngIf="isAdvancedPaymentAllocation">
    <span fxFlex="47%">Advanced Payment Allocation Transactions:</span>
    <span  fxFlex="53%">
      <mat-accordion>
        <mifosx-view-advance-paymeny-allocation *ngFor="let paymentAllocation of paymentAllocations"
          [paymentAllocation]="paymentAllocation"
          [advancePaymentAllocationData]="advancePaymentAllocationData">
        </mifosx-view-advance-paymeny-allocation>
      </mat-accordion>
    </span>
  </div>

  <div fxFlexFill *ngIf="isAdvancedPaymentAllocation && creditAllocations.length > 0">
    <span fxFlex="47%">Advanced Credit Allocation Transactions:</span>
    <span  fxFlex="53%">
      <mat-accordion>
        <mifosx-view-advance-paymeny-allocation *ngFor="let creditAllocation of creditAllocations"
          [creditAllocation]="creditAllocation"
          [advancePaymentAllocationData]="advancePaymentAllocationData">
        </mifosx-view-advance-paymeny-allocation>
      </mat-accordion>
    </span>
  </div>

  <h3 class="mat-h3" fxFlexFill>Down Payments</h3>

  <mat-divider [inset]="true"></mat-divider>

  <div fxFlexFill>
    <span fxFlex="47%">Enable Down Payments:</span>
    <span  fxFlex="53%">{{ loanProduct.enableDownPayment | yesNo }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.enableDownPayment" fxLayout="row wrap" fxLayout.lt-md="column">
    <span fxFlex="47%">Disbursed Amount Percentage Down Payment (%):</span>
    <span  fxFlex="53%">{{ loanProduct.disbursedAmountPercentageForDownPayment }} %</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.enableDownPayment" fxLayout="row wrap" fxLayout.lt-md="column">
    <span fxFlex="47%">Enable Auto Repayment for Down Payment:</span>
    <span  fxFlex="53%">{{ loanProduct.enableAutoRepaymentForDownPayment | yesNo }}</span>
  </div>

  <h3 class="mat-h3" fxFlexFill>Moratorium</h3>

  <div fxFlexFill *ngIf="loanProduct.delinquencyBucket">
    <span fxFlex="47%">Delinquency Bucket:</span>
    <span fxFlex="53%" *ngIf="loanProduct.delinquencyBucket.name">{{ loanProduct.delinquencyBucket.name }}</span>
    <span fxFlex="53%" *ngIf="!loanProduct.delinquencyBucket.name">{{ 'labels.inputs.Unassigned' | translate }}</span>
  </div>

  <div fxFlexFill *ngIf="!loanProduct.delinquencyBucket">
    <span fxFlex="47%">Delinquency Bucket:</span>
    <span fxFlex="53%">{{ 'labels.inputs.Unassigned' | translate }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Enable installment level Delinquency:</span>
    <span  fxFlex="53%">{{ loanProduct.enableInstallmentLevelDelinquency | yesNo }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.graceOnPrincipalPayment">
    <span fxFlex="47%">Grace on principal payment:</span>
    <span  fxFlex="53%">{{ loanProduct.graceOnPrincipalPayment }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.graceOnInterestPayment">
    <span fxFlex="47%">Grace on interest payment:</span>
    <span  fxFlex="53%">{{ loanProduct.graceOnInterestPayment }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.graceOnInterestCharged">
    <span fxFlex="47%">Interest free period:</span>
    <span  fxFlex="53%">{{ loanProduct.graceOnInterestCharged }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.inArrearsTolerance">
    <span fxFlex="47%">Arrears tolerance:</span>
    <span  fxFlex="53%">{{ loanProduct.inArrearsTolerance }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Days in year:</span>
    <span  fxFlex="53%">{{ loanProduct.daysInYearType?.value }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Days in month:</span>
    <span  fxFlex="53%">{{ loanProduct.daysInMonthType?.value }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Allow fixing of the installment amount:</span>
    <span  fxFlex="53%">{{ loanProduct.canDefineInstallmentAmount | yesNo }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.graceOnArrearsAgeing">
    <span fxFlex="47%">Number of days a loan may be overdue before moving into arrears:</span>
    <span  fxFlex="53%">{{ loanProduct.graceOnArrearsAgeing }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.overdueDaysForNPA">
    <span fxFlex="47%">Maximum number of days a loan may be overdue before becoming a NPA (non performing asset):</span>
    <span  fxFlex="53%">{{ loanProduct.overdueDaysForNPA }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Account moves out of NPA only after all arrears have been cleared:</span>
    <span  fxFlex="53%">{{ loanProduct.accountMovesOutOfNPAOnlyOnArrearsCompletion | yesNo }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.principalThresholdForLastInstallment">
    <span fxFlex="47%">Principal Threshold (%) for Last Instalment:</span>
    <span  fxFlex="53%">{{ loanProduct.principalThresholdForLastInstallment }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Variable Installments allowed:</span>
    <span  fxFlex="53%">{{ loanProduct.allowVariableInstallments | yesNo }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.allowVariableInstallments">
    <span fxFlex="47%">Variable Installments:</span>
    <span  fxFlex="53%">{{ '(Min: ' + loanProduct.minimumGap + ', Max: ' + (loanProduct.maximumGap ?
      loanProduct.maximumGap : loanProduct.minimumGap) + ')' }}</span>
  </div>

  <div fxFlexFill>
    <span fxFlex="47%">Allowed to be used for providing Topup Loans:</span>
    <span  fxFlex="53%">{{ loanProduct.canUseForTopup | yesNo }}</span>
  </div>

  <h3 class="mat-h3" fxFlexFill>Interest Recalculation</h3>

  <mat-divider [inset]="true"></mat-divider>

  <div fxFlexFill>
    <span fxFlex="47%">Recalculate Interest:</span>
    <span  fxFlex="53%">{{ loanProduct.isInterestRecalculationEnabled | yesNo }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.isInterestRecalculationEnabled" fxLayout="row wrap" fxLayout.lt-md="column">
    <span fxFlex="47%">Pre-closure interest calculation rule:</span>
    <span  fxFlex="53%">{{ loanProduct.interestRecalculationData.preClosureInterestCalculationStrategy.value }}</span>
    <span fxFlex="47%">Advance payments adjustment type:</span>
    <span  fxFlex="53%">{{ loanProduct.interestRecalculationData.rescheduleStrategyType.value }}</span>
    <span fxFlex="47%">Interest recalculation compounding on:</span>
    <span  fxFlex="53%">{{ loanProduct.interestRecalculationData.interestRecalculationCompoundingType.value }}</span>
    <div fxFlexFill *ngIf="loanProduct.interestRecalculationData.interestRecalculationCompoundingType.id !== 0"
      fxLayout="row wrap" fxLayout.lt-md="column">
      <span fxFlex="47%">Frequency for compounding:</span>
      <span  fxFlex="53%">
        {{ loanProduct.interestRecalculationData.recalculationCompoundingFrequencyType.value }}
        <span
          *ngIf="loanProduct.interestRecalculationData.recalculationCompoundingFrequencyType.id === 4 && loanProduct.interestRecalculationData.recalculationCompoundingFrequencyNthDay">&nbsp;&nbsp;{{
          'on ' + loanProduct.interestRecalculationData.recalculationCompoundingFrequencyNthDay?.value }}</span>
        <span
          *ngIf="(loanProduct.interestRecalculationData.recalculationCompoundingFrequencyType.id === 4 && !loanProduct.interestRecalculationData.recalculationCompoundingFrequencyOnDay) || loanProduct.interestRecalculationData.recalculationCompoundingFrequencyType.id === 3">&nbsp;&nbsp;{{
          loanProduct.interestRecalculationData.recalculationCompoundingFrequencyWeekday?.value }}</span>
        <span
          *ngIf="loanProduct.interestRecalculationData.recalculationCompoundingFrequencyType.id === 4 && loanProduct.interestRecalculationData.recalculationCompoundingFrequencyOnDay">&nbsp;&nbsp;{{
          'on day ' + loanProduct.interestRecalculationData.recalculationCompoundingFrequencyOnDay }}</span>
      </span>
      <div fxFlexFill *ngIf="loanProduct.interestRecalculationData.recalculationCompoundingFrequencyType.id !== 1"
        fxLayout="row wrap" fxLayout.lt-md="column">
        <span fxFlex="47%">Frequency Interval for compounding:</span>
        <span  fxFlex="53%">{{ loanProduct.interestRecalculationData.recalculationCompoundingFrequencyInterval }}</span>
      </div>
    </div>
    <div fxFlexFill fxLayout="row wrap" fxLayout.lt-md="column">
      <span fxFlex="47%">Frequency for recalculate Outstanding Principal:</span>
      <span  fxFlex="53%">
        {{ loanProduct.interestRecalculationData.recalculationRestFrequencyType.value }}
        <span
          *ngIf="loanProduct.interestRecalculationData.recalculationRestFrequencyType.id === 4 && loanProduct.interestRecalculationData.recalculationRestFrequencyNthDay">&nbsp;&nbsp;{{
          'on ' + loanProduct.interestRecalculationData.recalculationRestFrequencyNthDay?.value }}</span>
        <span
          *ngIf="(loanProduct.interestRecalculationData.recalculationRestFrequencyType.id === 4 && !loanProduct.interestRecalculationData.recalculationRestFrequencyOnDay) || loanProduct.interestRecalculationData.recalculationRestFrequencyType.id === 3">&nbsp;&nbsp;{{
          loanProduct.interestRecalculationData.recalculationRestFrequencyWeekday?.value }}</span>
        <span
          *ngIf="loanProduct.interestRecalculationData.recalculationRestFrequencyType.id === 4 && loanProduct.interestRecalculationData.recalculationRestFrequencyOnDay">&nbsp;&nbsp;{{
          'on day ' + loanProduct.interestRecalculationData.recalculationRestFrequencyOnDay }}</span>
      </span>
    </div>
    <div fxFlexFill *ngIf="loanProduct.interestRecalculationData.recalculationRestFrequencyType.id !== 1"
      fxLayout="row wrap" fxLayout.lt-md="column">
      <span fxFlex="47%">Frequency Interval for recalculation:</span>
      <span  fxFlex="53%">{{ loanProduct.interestRecalculationData.recalculationRestFrequencyInterval }}</span>
      <div fxFlexFill *ngIf="loanProduct.recalculationRestFrequencyDate">
        <span fxFlex="47%">Rest Frequency Date:</span>
        <span  fxFlex="53%">{{ loanProduct.interestRecalculationData.recalculationRestFrequencyDate }}</span>
      </div>
    </div>
    <div fxFlexFill>
      <span fxFlex="47%">Is Arrears recognization based on original schedule:</span>
      <span  fxFlex="53%">{{ loanProduct.isArrearsBasedOnOriginalSchedule | yesNo }}</span>
    </div>
  </div>

  <h3 class="mat-h3" fxFlexFill>Guarantee Requirements</h3>

  <mat-divider [inset]="true"></mat-divider>

  <div fxFlexFill>
    <span fxFlex="47%">Place Guarantee Funds On-Hold:</span>
    <span  fxFlex="53%">{{ loanProduct.holdGuaranteeFunds | yesNo }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.holdGuaranteeFunds" fxLayout="row wrap" fxLayout.lt-md="column">
    <span fxFlex="47%">Mandatory Guarantee(%):</span>
    <span  fxFlex="53%">{{ loanProduct.productGuaranteeData.mandatoryGuarantee }}</span>
    <div fxFlexFill *ngIf="loanProduct.productGuaranteeData.minimumGuaranteeFromOwnFunds">
      <span fxFlex="47%">Minimum Guarantee from Own Funds(%):</span>
      <span  fxFlex="53%">{{ loanProduct.productGuaranteeData.minimumGuaranteeFromOwnFunds }}</span>
    </div>
    <div fxFlexFill *ngIf="loanProduct.productGuaranteeData.minimumGuaranteeFromGuarantor">
      <span fxFlex="47%">Minimum Guarantee from Guarantor Funds(%):</span>
      <span  fxFlex="53%">{{ loanProduct.productGuaranteeData.minimumGuaranteeFromGuarantor }}</span>
    </div>
  </div>

  <h3 class="mat-h3" fxFlexFill>Loan Tranche Details</h3>

  <mat-divider [inset]="true"></mat-divider>

  <div fxFlexFill>
    <span fxFlex="47%">Enable Multiple Disbursals:</span>
    <span  fxFlex="53%">{{ loanProduct.multiDisburseLoan | yesNo }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.multiDisburseLoan" fxLayout="row wrap" fxLayout.lt-md="column">
    <span fxFlex="47%">Maximum Tranche count:</span>
    <span  fxFlex="53%">{{ loanProduct.maxTrancheCount }}</span>
    <div fxFlexFill *ngIf="loanProduct.outstandingLoanBalance">
      <span fxFlex="47%">Maximum allowed outstanding balance:</span>
      <span  fxFlex="53%">{{ loanProduct.outstandingLoanBalance }}</span>
    </div>
    <div fxFlexFill>
      <span fxFlex="47%">Disallow Expected Disbursements:</span>
      <span  fxFlex="53%">{{ loanProduct.disallowExpectedDisbursements | yesNo }}</span>
    </div>
  </div>

  <h3 class="mat-h3" fxFlexFill>Event Settings</h3>

  <div fxFlexFill>
    <span fxFlex="47%">Use the Global Configurations values to the Repayment Event (notifications):</span>
    <span  fxFlex="53%">{{ useDueForRepaymentsConfigurations | yesNo }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.dueDaysForRepaymentEvent">
    <span fxFlex="47%">Due days for repayment event:</span>
    <span  fxFlex="53%">{{ loanProduct.dueDaysForRepaymentEvent | number }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.overDueDaysForRepaymentEvent">
    <span fxFlex="47%">OverDue days for repayment event:</span>
    <span  fxFlex="53%">{{ loanProduct.overDueDaysForRepaymentEvent | number }}</span>
  </div>

  <h3 class="mat-h3" fxFlexFill>Configurable Terms and Settings</h3>

  <mat-divider [inset]="true"></mat-divider>

  <div fxFlexFill>
    <span fxFlex="47%">Allow overriding select terms and settings in loan accounts:</span>
    <span  fxFlex="53%">{{ loanProduct.allowAttributeConfiguration | yesNo }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.allowAttributeConfiguration" fxLayout="row wrap" fxLayout.lt-md="column">
    <span fxFlex="47%">Amortization:</span>
    <span  fxFlex="53%">{{ loanProduct.allowAttributeOverrides.amortizationType | yesNo }}</span>
    <span fxFlex="47%">Interest method:</span>
    <span  fxFlex="53%">{{ loanProduct.allowAttributeOverrides.interestType | yesNo }}</span>
    <span fxFlex="47%">Repayment strategy:</span>
    <span  fxFlex="53%">{{ loanProduct.allowAttributeOverrides.transactionProcessingStrategyCode | yesNo }}</span>
    <span fxFlex="47%">Interest calculation period:</span>
    <span  fxFlex="53%">{{ loanProduct.allowAttributeOverrides.interestCalculationPeriodType | yesNo }}</span>
    <span fxFlex="47%">Arrears tolerance:</span>
    <span  fxFlex="53%">{{ loanProduct.allowAttributeOverrides.inArrearsTolerance | yesNo }}</span>
    <span fxFlex="47%">Repaid every:</span>
    <span  fxFlex="53%">{{ loanProduct.allowAttributeOverrides.repaymentEvery | yesNo }}</span>
    <span fxFlex="47%">Moratorium:</span>
    <span  fxFlex="53%">{{ loanProduct.allowAttributeOverrides.graceOnPrincipalAndInterestPayment | yesNo }}</span>
    <span fxFlex="47%">Number of days a loan may be overdue before moving into arrears:</span>
    <span  fxFlex="53%">{{ loanProduct.allowAttributeOverrides.graceOnArrearsAgeing | yesNo }}</span>
  </div>

  <div fxFlexFill *ngIf="loanProduct.charges.length" fxLayout="row wrap" fxLayout.lt-md="column">

    <h3 class="mat-h3" fxFlexFill>Charges</h3>

    <mat-divider [inset]="true"></mat-divider>

    <table fxFlexFill class="mat-elevation-z1" mat-table
      [dataSource]="loanProduct.charges | chargesPenaltyFilter:false">

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef> Name </th>
        <td mat-cell *matCellDef="let charge">
          {{ charge.name + ', ' + charge.currency.displaySymbol }}
        </td>
      </ng-container>

      <ng-container matColumnDef="chargeCalculationType">
        <th mat-header-cell *matHeaderCellDef> Type </th>
        <td mat-cell *matCellDef="let charge">
          {{ charge.chargeCalculationType.value }}
        </td>
      </ng-container>

      <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef> Amount </th>
        <td mat-cell *matCellDef="let charge">
          {{ charge.amount }}
        </td>
      </ng-container>

      <ng-container matColumnDef="chargeTimeType">
        <th mat-header-cell *matHeaderCellDef> Collected On </th>
        <td mat-cell *matCellDef="let charge">
          {{ charge.chargeTimeType.value }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="chargesDisplayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: chargesDisplayedColumns;"></tr>

    </table>

    <h3 class="mat-h3" fxFlexFill>Overdue Charges</h3>

    <mat-divider [inset]="true"></mat-divider>

    <table fxFlexFill class="mat-elevation-z1" mat-table [dataSource]="loanProduct.charges | chargesPenaltyFilter:true">

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef> Name </th>
        <td mat-cell *matCellDef="let overdueCharge">
          {{ overdueCharge.name + ', ' + overdueCharge.currency.displaySymbol }}
        </td>
      </ng-container>

      <ng-container matColumnDef="chargeCalculationType">
        <th mat-header-cell *matHeaderCellDef> Type </th>
        <td mat-cell *matCellDef="let overdueCharge">
          {{ overdueCharge.chargeCalculationType.value }}
        </td>
      </ng-container>

      <ng-container matColumnDef="amount">
        <th mat-header-cell *matHeaderCellDef> Amount </th>
        <td mat-cell *matCellDef="let overdueCharge">
          {{ overdueCharge.amount }}
        </td>
      </ng-container>

      <ng-container matColumnDef="chargeTimeType">
        <th mat-header-cell *matHeaderCellDef> Collected On </th>
        <td mat-cell *matCellDef="let overdueCharge">
          {{ overdueCharge.chargeTimeType.value }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="chargesDisplayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: chargesDisplayedColumns;"></tr>

    </table>

  </div>

  <h3 class="mat-h3" fxFlexFill>Accounting</h3>

  <mat-divider [inset]="true"></mat-divider>

  <div fxFlexFill>
    <span fxFlex="47%">Type:</span>
    <span  fxFlex="53%">{{ accountingRuleData[accountingRule() - 1] }}</span>
  </div>

  <div fxFlexFill *ngIf="isAccountingEnabled()" fxLayout="row wrap"
    fxLayout.lt-md="column">

    <h4 fxFlexFill class="mat-h4">Assets / Liabilities</h4>

    <div fxFlexFill fxLayout="row wrap" fxLayout.lt-md="column">
      <mifosx-gl-account-display fxFlex="100%"
        [accountTitle]="'Fund source'" [glAccount]="accountingMappings.fundSourceAccount" [withTitle]="'47%'">
      </mifosx-gl-account-display>
    </div>

    <h4 fxFlexFill class="mat-h4">{{'labels.heading.Assets' | translate}}</h4>
    <div fxFlexFill fxLayout="row wrap" fxLayout.lt-md="column">
      <mifosx-gl-account-display fxFlex="100%"
        [accountTitle]="'Loan portfolio'" [glAccount]="accountingMappings.loanPortfolioAccount" [withTitle]="'47%'">
      </mifosx-gl-account-display>
      <div fxFlexFill *ngIf="loanProduct.accountingRule.id === 3 || loanProduct.accountingRule.id === 4"
        fxLayout="row wrap" fxLayout.lt-md="column">
        <mifosx-gl-account-display fxFlex="100%"
          [accountTitle]="'Interest Receivable'" [glAccount]="accountingMappings.receivableInterestAccount" [withTitle]="'47%'">
        </mifosx-gl-account-display>
        <mifosx-gl-account-display fxFlex="100%"
          [accountTitle]="'Fees Receivable'" [glAccount]="accountingMappings.receivableFeeAccount" [withTitle]="'47%'">
        </mifosx-gl-account-display>
        <mifosx-gl-account-display fxFlex="100%"
          [accountTitle]="'Penalties Receivable'" [glAccount]="accountingMappings.receivablePenaltyAccount" [withTitle]="'47%'">
        </mifosx-gl-account-display>
      </div>
      <mifosx-gl-account-display fxFlex="100%"
        [accountTitle]="'Transfer in suspense'" [glAccount]="accountingMappings.transfersInSuspenseAccount" [withTitle]="'47%'">
      </mifosx-gl-account-display>
    </div>

    <h4 fxFlexFill class="mat-h4">{{'labels.heading.Income' | translate}}</h4>
    <mifosx-gl-account-display fxFlex="100%"
      [accountTitle]="'Income from Interest'" [glAccount]="accountingMappings.interestOnLoanAccount" [withTitle]="'47%'">
    </mifosx-gl-account-display>
    <mifosx-gl-account-display fxFlex="100%"
      [accountTitle]="'Income from fees'" [glAccount]="accountingMappings.incomeFromFeeAccount" [withTitle]="'47%'">
    </mifosx-gl-account-display>
    <mifosx-gl-account-display fxFlex="100%"
      [accountTitle]="'Income from penalties'" [glAccount]="accountingMappings.incomeFromPenaltyAccount" [withTitle]="'47%'">
    </mifosx-gl-account-display>
    <mifosx-gl-account-display fxFlex="100%"
      [accountTitle]="'Income from Recovery Repayments'" [glAccount]="accountingMappings.incomeFromRecoveryAccount" [withTitle]="'47%'">
    </mifosx-gl-account-display>

    <mifosx-gl-account-display fxFlex="100%" *ngIf="accountingMappings.incomeFromChargeOffInterestAccount"
      [accountTitle]="'Income from ChargeOff Interest'" [glAccount]="accountingMappings.incomeFromChargeOffInterestAccount" [withTitle]="'47%'">
    </mifosx-gl-account-display>
    <mifosx-gl-account-display fxFlex="100%" *ngIf="accountingMappings.incomeFromChargeOffFeesAccount"
      [accountTitle]="'Income from ChargeOff Fees'" [glAccount]="accountingMappings.incomeFromChargeOffFeesAccount" [withTitle]="'47%'">
    </mifosx-gl-account-display>
    <mifosx-gl-account-display fxFlex="100%" *ngIf="accountingMappings.incomeFromChargeOffPenaltyAccount"
      [accountTitle]="'Income from ChargeOff Penalty'" [glAccount]="accountingMappings.incomeFromChargeOffPenaltyAccount" [withTitle]="'47%'">
    </mifosx-gl-account-display>


    <h4 fxFlexFill class="mat-h4">{{'labels.heading.Expenses' | translate}}</h4>

    <div fxFlexFill fxLayout="row wrap" fxLayout.lt-md="column">
    <mifosx-gl-account-display fxFlex="100%"
      [accountTitle]="'Losses written off'" [glAccount]="accountingMappings.writeOffAccount" [withTitle]="'47%'">
    </mifosx-gl-account-display>
    <mifosx-gl-account-display fxFlex="100%"
      [accountTitle]="'Expenses from Goodwill Credit'" [glAccount]="accountingMappings.goodwillCreditAccount" [withTitle]="'47%'">
    </mifosx-gl-account-display>
    <mifosx-gl-account-display fxFlex="100%" *ngIf="accountingMappings.chargeOffExpenseAccount"
      [accountTitle]="'ChargeOff Expense'" [glAccount]="accountingMappings.chargeOffExpenseAccount" [withTitle]="'47%'">
    </mifosx-gl-account-display>
    <mifosx-gl-account-display fxFlex="100%" *ngIf="accountingMappings.chargeOffFraudExpenseAccount"
      [accountTitle]="'ChargeOff Fraud Expense'" [glAccount]="accountingMappings.chargeOffFraudExpenseAccount" [withTitle]="'47%'">
    </mifosx-gl-account-display>

    <h4 fxFlexFill class="mat-h4">{{'labels.heading.Liabilities' | translate}}</h4>
    <mifosx-gl-account-display fxFlex="100%"
      [accountTitle]="'Over payment liability'" [glAccount]="accountingMappings.overpaymentLiabilityAccount" [withTitle]="'47%'">
    </mifosx-gl-account-display>

    <div
      *ngIf="isAdvancedAccountingEnabled()"
      fxFlexFill fxLayout="row wrap" fxLayout.lt-md="column">

      <h3 class="mat-h3" fxFlexFill>Advanced Accounting Rules</h3>

      <mat-divider [inset]="true"></mat-divider>

      <div *ngIf="paymentChannelToFundSourceMappings.length" fxFlexFill fxLayout="row wrap"
        fxLayout.lt-md="column">

        <h4 class="mat-h4" fxFlexFill>Fund Sources for Payment Channels</h4>

        <table fxFlexFill class="mat-elevation-z1" mat-table
          [dataSource]="paymentChannelToFundSourceMappings">

          <ng-container matColumnDef="paymentTypeId">
            <th mat-header-cell *matHeaderCellDef> Payment Type </th>
            <td mat-cell *matCellDef="let paymentFundSource">
              {{ paymentFundSource.paymentType.name }}
            </td>
          </ng-container>

          <ng-container matColumnDef="fundSourceAccountId">
            <th mat-header-cell *matHeaderCellDef> Fund Source </th>
            <td mat-cell *matCellDef="let paymentFundSource">
              {{ paymentFundSource.fundSourceAccount.name }}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="paymentFundSourceDisplayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: paymentFundSourceDisplayedColumns;"></tr>

        </table>

      </div>

      <div *ngIf="feeToIncomeAccountMappings.length" fxFlexFill fxLayout="row wrap"
        fxLayout.lt-md="column">

        <h4 class="mat-h4" fxFlexFill>Fees to Specific Income Accounts</h4>

        <table fxFlexFill class="mat-elevation-z1" mat-table [dataSource]="feeToIncomeAccountMappings">

          <ng-container matColumnDef="chargeId">
            <th mat-header-cell *matHeaderCellDef> Fees </th>
            <td mat-cell *matCellDef="let feesIncome">
              {{ feesIncome.charge.name }}
            </td>
          </ng-container>

          <ng-container matColumnDef="incomeAccountId">
            <th mat-header-cell *matHeaderCellDef> Income Account </th>
            <td mat-cell *matCellDef="let feesIncome">
              <span *ngIf="feesIncome.incomeAccount">
                {{ feesIncome.incomeAccount.name }}
              </span>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="feesPenaltyIncomeDisplayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: feesPenaltyIncomeDisplayedColumns;"></tr>

        </table>

      </div>

      <div *ngIf="penaltyToIncomeAccountMappings.length" fxFlexFill fxLayout="row wrap"
        fxLayout.lt-md="column">

        <h4 class="mat-h4" fxFlexFill>Penalties to Specific Income Accounts</h4>

        <table fxFlexFill class="mat-elevation-z1" mat-table [dataSource]="penaltyToIncomeAccountMappings">

          <ng-container matColumnDef="chargeId">
            <th mat-header-cell *matHeaderCellDef> Penalty </th>
            <td mat-cell *matCellDef="let penaltyIncome">
              {{ penaltyIncome.charge.name }}
            </td>
          </ng-container>

          <ng-container matColumnDef="incomeAccountId">
            <th mat-header-cell *matHeaderCellDef> Income Account </th>
            <td mat-cell *matCellDef="let penaltyIncome">
              {{ penaltyIncome.incomeAccount.name }}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="feesPenaltyIncomeDisplayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: feesPenaltyIncomeDisplayedColumns;"></tr>

        </table>

      </div>

    </div>

  </div>

</div>
